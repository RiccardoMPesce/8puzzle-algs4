Possible improvement: caching the content of some repeated computations
Possible improvement: caching the content of some repeated computations
